function Encrypt-File {
    param(
        [String]$InputFile,
        [String]$OutputFile,
        [String]$Password
    )

    $key = New-Object Byte[] 32
    $encoding = [Text.Encoding]::UTF8
    [Buffer]::BlockCopy($encoding.GetBytes($Password), 0, $key, 0, [Math]::Min($key.Length, $encoding.GetByteCount($Password)))

    $aesManaged = New-Object System.Security.Cryptography.AesCryptoServiceProvider
    $aesManaged.Key = $key
    $aesManaged.IV = $key[0..15]
    $aesManaged.Mode = [System.Security.Cryptography.CipherMode]::CBC

    $plainData = [System.IO.File]::ReadAllBytes($InputFile)
    $encryptor = $aesManaged.CreateEncryptor($aesManaged.Key, $aesManaged.IV)
    $encryptedData = $encryptor.TransformFinalBlock($plainData, 0, $plainData.Length)

    [System.IO.File]::WriteAllBytes($OutputFile, $encryptedData)

    $aesManaged.Dispose()
}

$InputFile = "path of yout malware"
$OutputFile = "path of output encrypted malware file"
$Password = "R7b@93#zF4$Tg21q"

Encrypt-File -InputFile $InputFile -OutputFile $OutputFile -Password $Password
